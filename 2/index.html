<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAP Assistant Pro - –£–º–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –ø–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º SAP</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=72&display=swap" rel="stylesheet">
    <style>
        :root {
            --sap-blue: #0A6ED1;
            --sap-blue-dark: #0854A0;
            --sap-blue-light: #E8F2FA;
            --sap-green: #188918;
            --sap-orange: #E76500;
            --sap-red: #BB0000;
            --sap-gray: #6A6D70;
            --sap-gray-light: #F5F6F7;
            --sap-gray-border: #D9D9D9;
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            --shadow-hover: 0 4px 20px rgba(0, 0, 0, 0.12);
            --radius: 8px;
            --radius-sm: 4px;
            --transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: '72', 'Roboto', Arial, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
            color: #32363A;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 24px;
            animation: fadeIn 0.8s ease-out;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { transform: translateX(-20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Header */
        .header {
            grid-column: 1 / -1;
            background: white;
            border-radius: var(--radius);
            padding: 20px 30px;
            box-shadow: var(--shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            border-left: 6px solid var(--sap-blue);
            animation: slideIn 0.6s ease-out;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            background: var(--sap-blue);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 12px rgba(10, 110, 209, 0.3);
        }

        .logo-text h1 {
            font-size: 24px;
            font-weight: 700;
            color: var(--sap-blue-dark);
            margin-bottom: 4px;
        }

        .logo-text p {
            font-size: 14px;
            color: var(--sap-gray);
        }

        .user-section {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
            background: var(--sap-gray-light);
            padding: 8px 16px;
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition);
        }

        .user-info:hover {
            background: #e0e0e0;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--sap-blue), #4CAF50);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 16px;
        }

        .user-name {
            font-weight: 500;
        }

        /* Sidebar */
        .sidebar {
            background: white;
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        .nav-section {
            margin-bottom: 30px;
        }

        .nav-title {
            font-size: 12px;
            text-transform: uppercase;
            color: var(--sap-gray);
            margin-bottom: 15px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .nav-list {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 8px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: var(--radius-sm);
            color: #32363A;
            text-decoration: none;
            transition: var(--transition);
            font-weight: 500;
        }

        .nav-link:hover {
            background: var(--sap-blue-light);
            color: var(--sap-blue);
            transform: translateX(5px);
        }

        .nav-link.active {
            background: var(--sap-blue);
            color: white;
        }

        .nav-link i {
            width: 20px;
            text-align: center;
        }

        .stats {
            background: var(--sap-gray-light);
            border-radius: var(--radius);
            padding: 20px;
            margin-top: 30px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 14px;
        }

        .stat-value {
            font-weight: 600;
            color: var(--sap-blue);
        }

        /* Main Content */
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        /* Search Bar */
        .search-section {
            background: white;
            border-radius: var(--radius);
            padding: 20px;
            box-shadow: var(--shadow);
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .search-box {
            flex: 1;
            min-width: 300px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 14px 20px 14px 50px;
            border: 1px solid var(--sap-gray-border);
            border-radius: var(--radius);
            font-size: 16px;
            transition: var(--transition);
            background: var(--sap-gray-light);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--sap-blue);
            box-shadow: 0 0 0 3px rgba(10, 110, 209, 0.1);
            background: white;
        }

        .search-icon {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--sap-gray);
        }

        .filter-select {
            padding: 14px 20px;
            border: 1px solid var(--sap-gray-border);
            border-radius: var(--radius);
            background: white;
            font-size: 16px;
            min-width: 200px;
            cursor: pointer;
            transition: var(--transition);
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--sap-blue);
        }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: var(--radius);
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: center;
        }

        .btn-primary {
            background: var(--sap-blue);
            color: white;
        }

        .btn-primary:hover {
            background: var(--sap-blue-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .btn-success {
            background: var(--sap-green);
            color: white;
        }

        .btn-success:hover {
            background: #156615;
            transform: translateY(-2px);
        }

        /* Cards Grid */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }

        .card {
            background: white;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            animation: fadeIn 0.5s ease-out;
            cursor: pointer;
            border-top: 4px solid var(--sap-blue);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }

        .card-header {
            padding: 20px;
            border-bottom: 1px solid var(--sap-gray-border);
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #32363A;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .card-module {
            display: inline-block;
            background: var(--sap-blue-light);
            color: var(--sap-blue);
            padding: 4px 12px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .card-transaction {
            color: var(--sap-gray);
            font-size: 14px;
            margin-bottom: 10px;
        }

        .card-body {
            padding: 20px;
        }

        .card-steps {
            color: #5E6C84;
            font-size: 14px;
            margin-bottom: 15px;
            line-height: 1.5;
            max-height: 60px;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
        }

        .card-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }

        .tag {
            background: var(--sap-gray-light);
            padding: 4px 10px;
            border-radius: 50px;
            font-size: 12px;
            color: var(--sap-gray);
        }

        .card-footer {
            padding: 15px 20px;
            background: var(--sap-gray-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border: 1px solid var(--sap-gray-border);
            color: var(--sap-gray);
            cursor: pointer;
            transition: var(--transition);
        }

        .action-btn:hover {
            background: var(--sap-blue-light);
            color: var(--sap-blue);
            transform: scale(1.1);
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
            animation: fadeIn 0.3s ease-out;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: var(--radius);
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.4s ease-out;
        }

        .modal-header {
            padding: 25px 30px;
            border-bottom: 1px solid var(--sap-gray-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 600;
            color: #32363A;
        }

        .modal-close {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--sap-gray-light);
            border: none;
            cursor: pointer;
            font-size: 20px;
            color: var(--sap-gray);
            transition: var(--transition);
        }

        .modal-close:hover {
            background: #e0e0e0;
            transform: rotate(90deg);
        }

        .modal-body {
            padding: 30px;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #32363A;
        }

        .form-control {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid var(--sap-gray-border);
            border-radius: var(--radius-sm);
            font-size: 16px;
            transition: var(--transition);
            background: white;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--sap-blue);
            box-shadow: 0 0 0 3px rgba(10, 110, 209, 0.1);
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
        }

        .steps-container {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .step-input {
            flex: 1;
        }

        .btn-icon {
            width: 46px;
            height: 46px;
            padding: 0;
            border-radius: var(--radius-sm);
        }

        .media-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .media-tag {
            background: var(--sap-blue-light);
            color: var(--sap-blue);
            padding: 8px 16px;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .modal-footer {
            padding: 20px 30px;
            border-top: 1px solid var(--sap-gray-border);
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            background: var(--sap-gray-light);
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 30px;
            right: 30px;
            padding: 18px 24px;
            border-radius: var(--radius);
            color: white;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: var(--shadow-hover);
            z-index: 1001;
            animation: slideIn 0.3s ease-out;
            max-width: 400px;
        }

        .notification.success {
            background: var(--sap-green);
            border-left: 4px solid #0F6B0F;
        }

        .notification.error {
            background: var(--sap-red);
            border-left: 4px solid #990000;
        }

        .notification.warning {
            background: var(--sap-orange);
            border-left: 4px solid #CC5800;
        }

        .notification.info {
            background: var(--sap-blue);
            border-left: 4px solid var(--sap-blue-dark);
        }

        /* Empty State */
        .empty-state {
            grid-column: 1 / -1;
            text-align: center;
            padding: 60px 20px;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        .empty-icon {
            font-size: 64px;
            color: var(--sap-gray-border);
            margin-bottom: 20px;
        }

        .empty-title {
            font-size: 24px;
            margin-bottom: 12px;
            color: #32363A;
        }

        .empty-text {
            color: var(--sap-gray);
            max-width: 500px;
            margin: 0 auto 30px;
        }

        /* AI Assistant */
        .ai-assistant {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 999;
        }

        .ai-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.5);
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ai-button:hover {
            transform: scale(1.1) rotate(10deg);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.7);
        }

        .ai-panel {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 400px;
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow-hover);
            display: none;
            overflow: hidden;
        }

        .ai-panel.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        .ai-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ai-body {
            padding: 20px;
            max-height: 300px;
            overflow-y: auto;
        }

        .ai-message {
            background: var(--sap-gray-light);
            padding: 12px 16px;
            border-radius: var(--radius);
            margin-bottom: 10px;
            font-size: 14px;
        }

        .ai-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--sap-gray-border);
            border-radius: var(--radius);
            font-size: 14px;
        }

        /* Welcome Screen */
        .welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            animation: fadeIn 0.5s ease-out;
        }

        .welcome-logo {
            font-size: 80px;
            color: var(--sap-blue);
            margin-bottom: 30px;
            animation: pulse 2s infinite;
        }

        .welcome-title {
            font-size: 36px;
            margin-bottom: 20px;
            color: #32363A;
            text-align: center;
        }

        .welcome-subtitle {
            font-size: 18px;
            color: var(--sap-gray);
            margin-bottom: 40px;
            text-align: center;
            max-width: 600px;
        }

        .welcome-form {
            width: 100%;
            max-width: 400px;
        }

        .welcome-input {
            width: 100%;
            padding: 18px 24px;
            border: 2px solid var(--sap-gray-border);
            border-radius: var(--radius);
            font-size: 18px;
            margin-bottom: 20px;
            text-align: center;
            transition: var(--transition);
        }

        .welcome-input:focus {
            outline: none;
            border-color: var(--sap-blue);
        }

        /* Loader */
        .loader {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid var(--sap-gray-light);
            border-top: 3px solid var(--sap-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: static;
                margin-bottom: 20px;
            }
            
            .cards-grid {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }
            
            .search-section {
                flex-direction: column;
            }
            
            .search-box, .filter-select {
                min-width: 100%;
            }
            
            .cards-grid {
                grid-template-columns: 1fr;
            }
            
            .ai-panel {
                width: calc(100vw - 60px);
                right: -15px;
            }
        }
    </style>
</head>
<body>
    <!-- Welcome Screen -->
    <div id="welcomeScreen" class="welcome-screen">
        <div class="welcome-logo">
            <i class="fas fa-chart-line"></i>
        </div>
        <h1 class="welcome-title">SAP Assistant Pro</h1>
        <p class="welcome-subtitle">–í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ SAP. –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –∏ –∑–∞—â–∏—â–µ–Ω—ã.</p>
        <div class="welcome-form">
            <input type="text" id="userNameInput" class="welcome-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è" maxlength="30">
            <button id="startButton" class="btn btn-primary" style="width: 100%; padding: 18px;">
                <i class="fas fa-rocket"></i> –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É
            </button>
        </div>
        <p style="margin-top: 30px; color: var(--sap-gray); font-size: 14px;">
            <i class="fas fa-lock"></i> –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
        </p>
    </div>

    <!-- Main Application -->
    <div id="app" style="display: none;">
        <div class="container">
            <!-- Header -->
            <header class="header">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="logo-text">
                        <h1>SAP Assistant Pro</h1>
                        <p>–£–º–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π SAP</p>
                    </div>
                </div>
                <div class="user-section">
                    <div class="data-actions">
                        <button class="btn" onclick="exportData()" title="–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö">
                            <i class="fas fa-download"></i> –≠–∫—Å–ø–æ—Ä—Ç
                        </button>
                        <button class="btn" onclick="importData()" title="–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö">
                            <i class="fas fa-upload"></i> –ò–º–ø–æ—Ä—Ç
                        </button>
                    </div>
                    <div class="user-info" onclick="showUserMenu()">
                        <div class="user-avatar" id="userAvatar">U</div>
                        <div>
                            <div class="user-name" id="userName">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</div>
                            <div style="font-size: 12px; color: var(--sap-gray);">Online</div>
                        </div>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </div>
            </header>

            <!-- Sidebar -->
            <aside class="sidebar">
                <nav class="nav-section">
                    <h3 class="nav-title">–ù–∞–≤–∏–≥–∞—Ü–∏—è</h3>
                    <ul class="nav-list">
                        <li class="nav-item">
                            <a href="#" class="nav-link active" onclick="showSection('all')">
                                <i class="fas fa-th-large"></i> –í—Å–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" onclick="showSection('favorites')">
                                <i class="fas fa-star"></i> –ò–∑–±—Ä–∞–Ω–Ω–æ–µ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" onclick="showSection('recent')">
                                <i class="fas fa-history"></i> –ù–µ–¥–∞–≤–Ω–∏–µ
                            </a>
                        </li>
                    </ul>
                </nav>

                <nav class="nav-section">
                    <h3 class="nav-title">–ú–æ–¥—É–ª–∏ SAP</h3>
                    <ul class="nav-list" id="moduleList">
                        <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
                    </ul>
                </nav>

                <div class="stats">
                    <h3 class="nav-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                    <div class="stat-item">
                        <span>–í—Å–µ–≥–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π:</span>
                        <span class="stat-value" id="totalInstructions">0</span>
                    </div>
                    <div class="stat-item">
                        <span>–ò–∑–±—Ä–∞–Ω–Ω—ã—Ö:</span>
                        <span class="stat-value" id="favoriteCount">0</span>
                    </div>
                    <div class="stat-item">
                        <span>–ú–æ–¥—É–ª–µ–π:</span>
                        <span class="stat-value" id="moduleCount">0</span>
                    </div>
                    <div class="stat-item">
                        <span>–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:</span>
                        <span class="stat-value" id="activityScore">0%</span>
                    </div>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="main-content">
                <!-- Search Section -->
                <section class="search-section">
                    <div class="search-box">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" id="searchInput" class="search-input" placeholder="–ü–æ–∏—Å–∫ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, —Ç–µ–≥–æ–≤..." oninput="searchInstructions()">
                    </div>
                    <select id="moduleFilter" class="filter-select" onchange="filterByModule()">
                        <option value="">–í—Å–µ –º–æ–¥—É–ª–∏</option>
                        <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
                    </select>
                    <button class="btn btn-primary" onclick="showNewInstructionModal()">
                        <i class="fas fa-plus"></i> –ù–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
                    </button>
                </section>

                <!-- Instructions Grid -->
                <section id="instructionsGrid" class="cards-grid">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
                </section>

                <!-- Empty State -->
                <div id="emptyState" class="empty-state" style="display: none;">
                    <div class="empty-icon">
                        <i class="fas fa-file-alt"></i>
                    </div>
                    <h2 class="empty-title">–ù–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π</h2>
                    <p class="empty-text">–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ—é –ø–µ—Ä–≤—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é, –Ω–∞–∂–∞–≤ –∫–Ω–æ–ø–∫—É "–ù–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è", –∏–ª–∏ –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å AI –ø–æ–º–æ—â–Ω–∏–∫–æ–º –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è.</p>
                    <button class="btn btn-primary" onclick="showNewInstructionModal()">
                        <i class="fas fa-plus"></i> –°–æ–∑–¥–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
                    </button>
                </div>
            </main>
        </div>

        <!-- AI Assistant -->
        <div class="ai-assistant">
            <div class="ai-panel" id="aiPanel">
                <div class="ai-header">
                    <h3 style="display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-robot"></i> SAP AI –ü–æ–º–æ—â–Ω–∏–∫
                    </h3>
                    <button class="modal-close" onclick="toggleAIPanel()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="ai-body" id="aiMessages">
                    <div class="ai-message">
                        üëã <strong>–ü—Ä–∏–≤–µ—Ç! –Ø SAP AI Assistant - –≤–∞—à —ç–∫—Å–ø–µ—Ä—Ç –ø–æ —Å–∏—Å—Ç–µ–º–µ SAP!</strong><br><br>
                        
                        üéØ <u>–Ø –º–æ–≥—É –ø–æ–º–æ—á—å —Å:</u><br>
                        ‚Ä¢ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –ø–æ –º–æ–¥—É–ª—è–º SAP<br>
                        ‚Ä¢ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –∏ –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ–º<br>
                        ‚Ä¢ –°–æ–∑–¥–∞–Ω–∏–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π<br>
                        ‚Ä¢ –†–µ—à–µ–Ω–∏–µ–º —Ç–∏–ø–æ–≤—ã—Ö –ø—Ä–æ–±–ª–µ–º<br>
                        ‚Ä¢ –õ—É—á—à–∏–º–∏ –ø—Ä–∞–∫—Ç–∏–∫–∞–º–∏<br><br>
                        
                        üí° <u>–ü—Ä–∏–º–µ—Ä—ã –≤–æ–ø—Ä–æ—Å–æ–≤:</u><br>
                        ‚Ä¢ "–ö–∞–∫–∏–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –º–æ–¥—É–ª–µ MM?"<br>
                        ‚Ä¢ "–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ –Ω–∞ –∑–∞–∫—É–ø–∫—É?"<br>
                        ‚Ä¢ "–ß—Ç–æ –¥–µ–ª–∞–µ—Ç FB01?"<br>
                        ‚Ä¢ "–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ SAP"<br><br>
                        
                        <em>–ó–∞–¥–∞–≤–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ —Ä—É—Å—Å–∫–æ–º –∏–ª–∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ!</em>
                    </div>
                </div>
                <div style="padding: 15px; border-top: 1px solid var(--sap-gray-border);">
                    <input type="text" id="aiInput" class="ai-input" placeholder="–°–ø—Ä–æ—Å–∏—Ç–µ –æ –º–æ–¥—É–ª–µ SAP –∏–ª–∏ –ø–æ–ø—Ä–æ—Å–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é..." onkeypress="handleAIKeyPress(event)">
                </div>
            </div>
            <button class="ai-button" onclick="toggleAIPanel()">
                <i class="fas fa-robot"></i>
            </button>
        </div>
    </div>

    <!-- Instruction Modal -->
    <div id="instructionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">–ù–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</h2>
                <button class="modal-close" onclick="hideModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="instructionForm">
                    <input type="hidden" id="instructionId">
                    
                    <div class="form-group">
                        <label class="form-label" for="instructionTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ *</label>
                        <input type="text" id="instructionTitle" class="form-control" required maxlength="100">
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="instructionModule">–ú–æ–¥—É–ª—å SAP *</label>
                        <select id="instructionModule" class="form-control" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥—É–ª—å</option>
                            <option value="FI">–§–∏–Ω–∞–Ω—Å—ã (FI)</option>
                            <option value="CO">–ö–æ–Ω—Ç—Ä–æ–ª–ª–∏–Ω–≥ (CO)</option>
                            <option value="MM">–ú–∞—Ç–µ—Ä–∏–∞–ª—ã (MM)</option>
                            <option value="SD">–ü—Ä–æ–¥–∞–∂–∏ (SD)</option>
                            <option value="PP">–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ (PP)</option>
                            <option value="QM">–ö–∞—á–µ—Å—Ç–≤–æ (QM)</option>
                            <option value="PM">–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (PM)</option>
                            <option value="HR">–ö–∞–¥—Ä—ã (HR)</option>
                            <option value="PS">–ü—Ä–æ–µ–∫—Ç—ã (PS)</option>
                            <option value="WM">–°–∫–ª–∞–¥ (WM)</option>
                            <option value="BASIS">–ë–∞–∑–∏—Å (BASIS)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="transactionCode">–ö–æ–¥ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</label>
                        <input type="text" id="transactionCode" class="form-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: FB01, VA01, ME21N">
                    </div>

                    <div class="form-group">
                        <label class="form-label">–®–∞–≥–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ *</label>
                        <div id="stepsContainer">
                            <div class="steps-container">
                                <input type="text" class="form-control step-input" placeholder="–®–∞–≥ 1">
                                <button type="button" class="btn btn-icon" onclick="addStep()">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">–ú–µ–¥–∏–∞ (—Å—Å—ã–ª–∫–∏ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –≤–∏–¥–µ–æ, –¥–æ–∫—É–º–µ–Ω—Ç—ã)</label>
                        <div class="steps-container">
                            <input type="url" id="mediaInput" class="form-control step-input" placeholder="https://example.com/screenshot.png">
                            <button type="button" class="btn btn-icon" onclick="addMedia()">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                        <div class="media-container" id="mediaContainer">
                            <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">–¢–µ–≥–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                        <input type="text" id="instructionTags" class="form-control" placeholder="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞, –æ—Ç—á–µ—Ç, –¥–µ–±–µ—Ç, –∫—Ä–µ–¥–∏—Ç">
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="instructionNotes">–ü—Ä–∏–º–µ—á–∞–Ω–∏—è</label>
                        <textarea id="instructionNotes" class="form-control" rows="3" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn" onclick="hideModal()">
                    <i class="fas fa-times"></i> –û—Ç–º–µ–Ω–∞
                </button>
                <button type="button" class="btn btn-success" onclick="saveInstruction()">
                    <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                </button>
                <button type="button" class="btn btn-primary" id="aiGenerateBtn" onclick="generateWithAI()">
                    <i class="fas fa-robot"></i> AI –ì–µ–Ω–µ—Ä–∞—Ü–∏—è
                </button>
            </div>
        </div>
    </div>

    <!-- User Menu -->
    <div id="userMenu" class="modal" style="align-items: flex-start; justify-content: flex-end; padding-top: 80px;">
        <div class="modal-content" style="max-width: 300px; margin: 0 20px;">
            <div class="modal-header">
                <h3 class="modal-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                    <input type="text" id="changeUserName" class="form-control">
                </div>
                <div class="form-group">
                    <label class="form-label">–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</label>
                    <select id="autoSave" class="form-control">
                        <option value="true">–í–∫–ª—é—á–µ–Ω–æ</option>
                        <option value="false">–í—ã–∫–ª—é—á–µ–Ω–æ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">–¢–µ–º–∞</label>
                    <select id="themeSelect" class="form-control">
                        <option value="light">–°–≤–µ—Ç–ª–∞—è</option>
                        <option value="dark">–¢–µ–º–Ω–∞—è</option>
                        <option value="fiori">SAP Fiori</option>
                    </select>
                </div>
                <button class="btn btn-primary" style="width: 100%; margin-top: 20px;" onclick="clearUserData()">
                    <i class="fas fa-trash"></i> –û—á–∏—Å—Ç–∏—Ç—å –º–æ–∏ –¥–∞–Ω–Ω—ã–µ
                </button>
            </div>
            <div class="modal-footer">
                <button class="btn" onclick="hideUserMenu()">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer"></div>

    <script>
        // ===================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï =====================
        let currentUser = null;
        let instructions = [];
        let currentSection = 'all';
        let currentFilter = '';
        let aiPanelVisible = false;

        // ===================== –£–ú–ù–´–ô SAP AI –≠–ö–°–ü–ï–†–¢ =====================
        class SAPAIExpert {
            constructor() {
                this.knowledgeBase = this.createKnowledgeBase();
                this.conversationHistory = [];
                this.userContext = {};
            }
            
            createKnowledgeBase() {
                return {
                    modules: {
                        'FI': {
                            description: '–ú–æ–¥—É–ª—å –§–∏–Ω–∞–Ω—Å—ã (FI) - –±—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–π —É—á–µ—Ç, –≥–ª–∞–≤–Ω–∞—è –∫–Ω–∏–≥–∞, –¥–µ–±–∏—Ç–æ—Ä—ã/–∫—Ä–µ–¥–∏—Ç–æ—Ä—ã',
                            commonTransactions: {
                                'FB01': '–í–≤–æ–¥ –æ–±—â–µ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞',
                                'FB02': '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞',
                                'FB03': '–ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞',
                                'FB04': '–û—Ç–º–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞',
                                'FB50': '–í–≤–æ–¥ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å —ç–∫—Ä–∞–Ω–∞',
                                'FB60': '–í–≤–æ–¥ —Å—á–µ—Ç–∞ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞',
                                'FB65': '–í–≤–æ–¥ —Å—á–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞',
                                'FB70': '–í—ã—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç—É',
                                'FB75': '–°—Ç–æ—Ä–Ω–æ —Å—á–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç—É',
                                'F-02': '–í–≤–æ–¥ –ø—Ä–æ–≤–æ–¥–∫–∏',
                                'F-22': '–í—ã—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç—É',
                                'F-28': '–ü—Ä–æ–≤–æ–¥–∫–∞ –ø–ª–∞—Ç–µ–∂–∞',
                                'F-44': '–°–ø–∏—Å–∞–Ω–∏–µ –¥–µ–±–∏—Ç–æ—Ä—Å–∫–æ–π –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏',
                                'F-53': '–ü–ª–∞—Ç–µ–∂ –ø–æ—Å—Ç–∞–≤—â–∏–∫—É',
                                'F110': '–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞',
                                'FD10N': '–û—Ç—á–µ—Ç –ø–æ –¥–µ–±–∏—Ç–æ—Ä–∞–º',
                                'FK10N': '–û—Ç—á–µ—Ç –ø–æ –∫—Ä–µ–¥–∏—Ç–æ—Ä–∞–º',
                                'FS10N': '–ê–Ω–∞–ª–∏–∑ –ì–ö',
                                'FBL1N': '–ü—Ä–æ–≤–æ–¥–∫–∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞',
                                'FBL3N': '–ü—Ä–æ–≤–æ–¥–∫–∏ –ì–ö',
                                'FBL5N': '–ü—Ä–æ–≤–æ–¥–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞'
                            },
                            bestPractices: [
                                '–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–ª—é—á–∏ —Ä–∞–∑–Ω–æ—Å–∫–∏',
                                '–†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–æ–¥–∏—Ç–µ —Ä–µ–∫–æ–Ω—Å–∏–ª—è—Ü–∏—é —Å—á–µ—Ç–æ–≤',
                                '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –ª–∏—Å—Ç—ã –¥–ª—è –º–µ—Å—è—á–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è',
                                '–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–æ–¥–∫–∏ –¥–ª—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –æ–ø–µ—Ä–∞—Ü–∏–π'
                            ]
                        },
                        'CO': {
                            description: '–ú–æ–¥—É–ª—å –ö–æ–Ω—Ç—Ä–æ–ª–ª–∏–Ω–≥ (CO) - —É—á–µ—Ç –∑–∞—Ç—Ä–∞—Ç, —Ü–µ–Ω—Ç—Ä—ã –ø—Ä–∏–±—ã–ª–∏, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∑–∞–∫–∞–∑—ã',
                            commonTransactions: {
                                'KB11N': '–í–≤–æ–¥ –ø–ª–∞–Ω–æ–≤—ã—Ö –∑–∞—Ç—Ä–∞—Ç',
                                'KB21N': '–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç',
                                'KB31N': '–†–∞—Å—á–µ—Ç —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏',
                                'KKS1': '–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –ö–ó',
                                'KKS2': '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –ö–ó',
                                'KKP6': '–†–∞—Å—á–µ—Ç —Ü–µ–Ω—ã –ø—Ä–æ–¥—É–∫—Ç–∞',
                                'KO88': '–ó–∞–∫—Ä—ã—Ç–∏–µ –∑–∞–∫–∞–∑–∞',
                                'KSV5': '–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ',
                                'KSU5': '–û—Ü–µ–Ω–∫–∞',
                                'S_ALR_87013611': '–û—Ç—á–µ—Ç –ø–æ —Ü–µ–Ω—Ç—Ä–∞–º –∑–∞—Ç—Ä–∞—Ç',
                                'S_ALR_87012993': '–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏'
                            }
                        },
                        'MM': {
                            description: '–ú–æ–¥—É–ª—å –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏ (MM) - –∑–∞–∫—É–ø–∫–∏, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∞—Å–∞–º–∏, –æ—Ü–µ–Ω–∫–∞',
                            commonTransactions: {
                                'ME21N': '–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –Ω–∞ –∑–∞–∫—É–ø–∫—É',
                                'ME22N': '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –Ω–∞ –∑–∞–∫—É–ø–∫—É',
                                'ME23N': '–ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–∞ –Ω–∞ –∑–∞–∫—É–ø–∫—É',
                                'ME29N': '–í—ã–ø—É—Å–∫ –∑–∞–∫–∞–∑–∞ –Ω–∞ –∑–∞–∫—É–ø–∫—É',
                                'ME31K': '–°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–∞',
                                'ME32K': '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–∞',
                                'ME51N': '–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏ –Ω–∞ –∑–∞–∫—É–ø–∫—É',
                                'ME54N': '–í—ã–ø—É—Å–∫ –∑–∞—è–≤–∫–∏',
                                'ME57': '–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞—è–≤–æ–∫',
                                'ME59N': '–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤',
                                'MIGO': '–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤/—É—Å–ª—É–≥',
                                'MIRO': '–í–≤–æ–¥ —Å—á–µ—Ç–∞ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞',
                                'MB1A': '–°–ø–∏—Å–∞–Ω–∏–µ',
                                'MB1B': '–ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ',
                                'MB1C': '–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ',
                                'MB51': '–°–ø–∏—Å–æ–∫ –¥–≤–∏–∂–µ–Ω–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª–∞',
                                'MMBE': '–ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–ø–∞—Å–æ–≤',
                                'MM03': '–ü—Ä–æ—Å–º–æ—Ç—Ä –º–∞—Ç–µ—Ä–∏–∞–ª–∞',
                                'MM02': '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞',
                                'MM01': '–°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞',
                                'MR21': '–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã –º–∞—Ç–µ—Ä–∏–∞–ª–∞',
                                'MR22': '–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã –≤ –∑–∞–∫–∞–∑–µ'
                            },
                            commonIssues: {
                                '–ú–∞—Ç–µ—Ä–∏–∞–ª –Ω–µ –Ω–∞–π–¥–µ–Ω': '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ MM03, –≤–æ–∑–º–æ–∂–Ω–æ –º–∞—Ç–µ—Ä–∏–∞–ª –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –∏–ª–∏ —É–¥–∞–ª–µ–Ω',
                                '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏': '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ MIGO, –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏ –ø–∞—Ä—Ç–∏–∏',
                                '–ù–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Å—á–µ—Ç': '–í MIRO –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∑–∞–∫–∞–∑—É –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ'
                            }
                        },
                        'SD': {
                            description: '–ú–æ–¥—É–ª—å –ü—Ä–æ–¥–∞–∂–∏ –∏ –¥–∏—Å—Ç—Ä–∏–±—É—Ü–∏—è (SD) - –∑–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤, –æ—Ç–≥—Ä—É–∑–∫–∏, –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç–æ–≤',
                            commonTransactions: {
                                'VA01': '–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –∫–ª–∏–µ–Ω—Ç–∞',
                                'VA02': '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –∫–ª–∏–µ–Ω—Ç–∞',
                                'VA03': '–ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–∞ –∫–ª–∏–µ–Ω—Ç–∞',
                                'VA05': '–°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤',
                                'VL01N': '–°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–≥—Ä—É–∑–∫–∏',
                                'VL02N': '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–≥—Ä—É–∑–∫–∏',
                                'VL03N': '–ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç–≥—Ä—É–∑–∫–∏',
                                'VF01': '–°–æ–∑–¥–∞–Ω–∏–µ —Å—á–µ—Ç–∞-—Ñ–∞–∫—Ç—É—Ä—ã',
                                'VF02': '–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—á–µ—Ç–∞-—Ñ–∞–∫—Ç—É—Ä—ã',
                                'VF03': '–ü—Ä–æ—Å–º–æ—Ç—Ä —Å—á–µ—Ç–∞-—Ñ–∞–∫—Ç—É—Ä—ã',
                                'VF04': '–°–ø–∏—Å–æ–∫ —Å—á–µ—Ç–æ–≤',
                                'VF11': '–û—Ç–º–µ–Ω–∞ —Å—á–µ—Ç–∞',
                                'VA11': '–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞',
                                'VA12': '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞',
                                'VA13': '–ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–ø—Ä–æ—Å–∞',
                                'VA21': '–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è',
                                'VA22': '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è',
                                'VA23': '–ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è',
                                'VA31': '–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞',
                                'VA32': '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞',
                                'VA33': '–ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞',
                                'VA41': '–°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è',
                                'VA42': '–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è',
                                'VA43': '–ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–≥–ª–∞—à–µ–Ω–∏—è',
                                'V.01': '–°–ø–∏—Å–æ–∫ –æ—Ç–≥—Ä—É–∑–æ–∫',
                                'V.02': '–°–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–∞–≤–æ–∫',
                                'V.03': '–°–ø–∏—Å–æ–∫ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤'
                            }
                        },
                        'PP': {
                            description: '–ú–æ–¥—É–ª—å –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ (PP) - –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ–º',
                            commonTransactions: {
                                'MD01': '–ó–∞–ø—É—Å–∫ MRP',
                                'MD02': '–ó–∞–ø—É—Å–∫ MRP –¥–ª—è –æ–¥–Ω–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞',
                                'MD03': '–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ MRP',
                                'MD04': '–ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–ø–∞—Å–æ–≤/–ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π',
                                'CO01': '–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞',
                                'CO02': '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞',
                                'CO03': '–ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞',
                                'CO11N': '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏',
                                'CO14': '–û—Ç–º–µ–Ω–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è',
                                'CO15': '–ú–∞—Å—Å–æ–≤–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ',
                                'CO27': '–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤',
                                'COHV': '–ú–∞—Å—Å–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫–∞–∑–æ–≤',
                                'COR1': '–ü—Ä–æ—Å–≤–µ—Ä–∫–∞ –∑–∞–∫–∞–∑–∞',
                                'COR2': '–ú–∞—Å—Å–æ–≤–∞—è —Å–≤–µ—Ä–∫–∞',
                                'CJ20N': '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏',
                                'CJ01': '–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ WBS',
                                'CJ02': '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ WBS',
                                'CJ03': '–ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ–µ–∫—Ç–∞ WBS'
                            }
                        }
                    },
                    
                    troubleshooting: {
                        '–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è': [
                            'SU01 - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏',
                            'PFCG - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏',
                            'SU53 - –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏',
                            'SU24 - –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏',
                            'SUIM - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π'
                        ],
                        '–û—Ç–ª–∞–¥–∫–∞': [
                            'ST22 - –ê–Ω–∞–ª–∏–∑ –∫–æ—Ä–æ—Ç–∫–∏—Ö –¥–∞–º–ø–æ–≤',
                            'SM21 - –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ª–æ–≥–∞',
                            'SM50 - –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–∞–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤',
                            'SM66 - –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä —Ä–∞–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤',
                            'SM13 - –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–ø–∏—Å–µ–π –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è',
                            'SM12 - –ü—Ä–æ—Å–º–æ—Ç—Ä –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫',
                            'SM04 - –ü—Ä–æ—Å–º–æ—Ç—Ä –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π'
                        ],
                        '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç—ã': [
                            'SE01 - –û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–≤',
                            'SE09 - –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—ã',
                            'SE10 - –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—ã',
                            'STMS - –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'
                        ],
                        '–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö': [
                            'DB02 - –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Ç–∞–±–ª–∏—Ü',
                            'DB12 - –ò—Å—Ç–æ—Ä–∏—è —Ç–∞–±–ª–∏—Ü',
                            'DB13 - –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ DBA',
                            'SM13 - –ó–∞–ø–∏—Å–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü'
                        ]
                    },
                    
                    templates: {
                        'FI': {
                            '–í–≤–æ–¥ —Å—á–µ—Ç–∞ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞': [
                                '–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é FB60',
                                '–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞',
                                '–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–ø–∞–Ω–∏—é',
                                '–í–≤–µ–¥–∏—Ç–µ –¥–∞—Ç—É –¥–æ–∫—É–º–µ–Ω—Ç–∞',
                                '–í–≤–µ–¥–∏—Ç–µ —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞ "KR"',
                                '–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É —Å—á–µ—Ç–∞',
                                '–í–≤–µ–¥–∏—Ç–µ –Ω–∞–ª–æ–≥–æ–≤—ã–π –∫–æ–¥',
                                '–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –ø–æ–∑–∏—Ü–∏–∏',
                                '–ù–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"',
                                '–ó–∞–ø–∏—à–∏—Ç–µ –Ω–æ–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞'
                            ],
                            '–ü—Ä–æ–≤–æ–¥–∫–∞ –ø–ª–∞—Ç–µ–∂–∞': [
                                '–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é F-28',
                                '–í–≤–µ–¥–∏—Ç–µ –¥–∞—Ç—É –¥–æ–∫—É–º–µ–Ω—Ç–∞',
                                '–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞ "DZ"',
                                '–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–ø–∞–Ω–∏—é',
                                '–£–∫–∞–∂–∏—Ç–µ —Å—á–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞/–ø–æ—Å—Ç–∞–≤—â–∏–∫–∞',
                                '–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –ø–ª–∞—Ç–µ–∂–∞',
                                '–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã',
                                '–í–≤–µ–¥–∏—Ç–µ –±–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã',
                                '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∞–ª—å–¥–æ',
                                '–ù–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"'
                            ]
                        },
                        'MM': {
                            '–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –Ω–∞ –∑–∞–∫—É–ø–∫—É': [
                                '–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é ME21N',
                                '–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∑–∞–∫–∞–∑–∞ "NB"',
                                '–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞',
                                '–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –∑–∞–∫—É–ø–æ–∫',
                                '–í–≤–µ–¥–∏—Ç–µ –≥—Ä—É–ø–ø—É –∑–∞–∫—É–ø–æ–∫',
                                '–î–æ–±–∞–≤—å—Ç–µ –ø–æ–∑–∏—Ü–∏–∏ —Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏',
                                '–£–∫–∞–∂–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ —Ü–µ–Ω—É',
                                '–í–≤–µ–¥–∏—Ç–µ –¥–∞—Ç—É –ø–æ—Å—Ç–∞–≤–∫–∏',
                                '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å–ª–æ–≤–∏—è',
                                '–ù–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"',
                                '–ó–∞–ø–∏—à–∏—Ç–µ –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞'
                            ],
                            '–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤': [
                                '–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é MIGO',
                                '–í—ã–±–µ—Ä–∏—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏—é "–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ"',
                                '–í—ã–±–µ—Ä–∏—Ç–µ –¥–≤–∏–∂–µ–Ω–∏–µ "101"',
                                '–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞',
                                '–û—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ —à—Ç—Ä–∏—Ö-–∫–æ–¥—ã –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤',
                                '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ',
                                '–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä—Ç–∏—é (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)',
                                '–ù–∞–∂–º–∏—Ç–µ "–ü—Ä–æ–≤–µ—Å—Ç–∏"',
                                '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø—Ä–æ–≤–æ–¥–∫—É'
                            ]
                        },
                        'SD': {
                            '–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –∫–ª–∏–µ–Ω—Ç–∞': [
                                '–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é VA01',
                                '–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∑–∞–∫–∞–∑–∞ "OR"',
                                '–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∫–ª–∏–µ–Ω—Ç–∞',
                                '–í–≤–µ–¥–∏—Ç–µ –¥–∞—Ç—É –∑–∞–∫–∞–∑–∞',
                                '–î–æ–±–∞–≤—å—Ç–µ –ø–æ–∑–∏—Ü–∏–∏ —Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏',
                                '–£–∫–∞–∂–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ —Ü–µ–Ω—É',
                                '–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª–æ–≤–∏—è –ø–æ—Å—Ç–∞–≤–∫–∏',
                                '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ',
                                '–ù–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"',
                                '–ó–∞–ø–∏—à–∏—Ç–µ –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞'
                            ],
                            '–°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–≥—Ä—É–∑–∫–∏': [
                                '–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é VL01N',
                                '–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞',
                                '–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –æ—Ç–≥—Ä—É–∑–∫–∏ "LF"',
                                '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏',
                                '–£–∫–∞–∂–∏—Ç–µ –¥–∞—Ç—É –æ—Ç–≥—Ä—É–∑–∫–∏',
                                '–ù–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"',
                                '–ü—Ä–æ–≤–µ–¥–∏—Ç–µ –æ—Ç–≥—Ä—É–∑–∫—É',
                                '–†–∞—Å–ø–µ—á–∞—Ç–∞–π—Ç–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—É—é –Ω–∞–∫–ª–∞–¥–Ω—É—é'
                            ]
                        }
                    },
                    
                    commonErrors: {
                        'MESSAGE_NO_AUTHORITY': '–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–æ–ª–∏',
                        'FUNCTION_NOT_FOUND': '–§—É–Ω–∫—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É –º–æ–¥—É–ª—è',
                        'MATERIAL_NOT_FOUND': '–ú–∞—Ç–µ—Ä–∏–∞–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ MM03',
                        'VENDOR_NOT_FOUND': '–ü–æ—Å—Ç–∞–≤—â–∏–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ XK03',
                        'CUSTOMER_NOT_FOUND': '–ö–ª–∏–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ XD03',
                        'DOCUMENT_ALREADY_EXISTS': '–î–æ–∫—É–º–µ–Ω—Ç —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ FB03',
                        'ACCOUNT_NOT_FOUND': '–°—á–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ FS00',
                        'COMPANY_CODE_NOT_FOUND': '–ö–æ–¥ –∫–æ–º–ø–∞–Ω–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ OX02'
                    }
                };
            }
            
            async processQuestion(question, context = {}) {
                this.conversationHistory.push({ role: 'user', content: question });
                this.userContext = { ...this.userContext, ...context };
                
                const lowerQuestion = question.toLowerCase();
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –∑–∞–ø—Ä–æ—Å–∞
                const response = this.analyzeQuestion(lowerQuestion, question);
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç–≤–µ—Ç –≤ –∏—Å—Ç–æ—Ä–∏—é
                this.conversationHistory.push({ role: 'assistant', content: response });
                
                // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ 10 —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
                if (this.conversationHistory.length > 20) {
                    this.conversationHistory = this.conversationHistory.slice(-20);
                }
                
                return response;
            }
            
            analyzeQuestion(lowerQuestion, originalQuestion) {
                // –ü–æ–∏—Å–∫ –ø–æ –º–æ–¥—É–ª—è–º SAP
                for (const [module, data] of Object.entries(this.knowledgeBase.modules)) {
                    if (lowerQuestion.includes(module.toLowerCase()) || 
                        lowerQuestion.includes(data.description.toLowerCase())) {
                        return this.generateModuleResponse(module, originalQuestion);
                    }
                }
                
                // –ü–æ–∏—Å–∫ –ø–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º
                const transactionMatch = originalQuestion.match(/\b[A-Z]{1,4}\d{1,4}[A-Z]?\b/g);
                if (transactionMatch) {
                    return this.generateTransactionResponse(transactionMatch[0]);
                }
                
                // –ü–æ–∏—Å–∫ –ø–æ —à–∞–±–ª–æ–Ω–∞–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
                if (lowerQuestion.includes('–∫–∞–∫ —Å–æ–∑–¥–∞—Ç—å') || 
                    lowerQuestion.includes('–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è') || 
                    lowerQuestion.includes('—à–∞–≥–∏')) {
                    return this.generateInstructionTemplate(originalQuestion);
                }
                
                // –ü–æ–∏—Å–∫ –ø–æ –ø—Ä–æ–±–ª–µ–º–∞–º
                if (lowerQuestion.includes('–æ—à–∏–±–∫–∞') || 
                    lowerQuestion.includes('–ø—Ä–æ–±–ª–µ–º–∞') || 
                    lowerQuestion.includes('–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç')) {
                    return this.generateTroubleshootingResponse(originalQuestion);
                }
                
                // –ü–æ–∏—Å–∫ –ø–æ –æ–±—â–∏–º —Ç–µ–º–∞–º
                const generalTopics = {
                    '–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è': 'troubleshooting.–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è',
                    '–æ—Ç–ª–∞–¥–∫–∞': 'troubleshooting.–û—Ç–ª–∞–¥–∫–∞',
                    '—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç': 'troubleshooting.–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç—ã',
                    '–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö': 'troubleshooting.–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö',
                    '—Ñ–∏–Ω–∞–Ω—Å': 'modules.FI',
                    '–º–∞—Ç–µ—Ä–∏–∞–ª': 'modules.MM',
                    '–ø—Ä–æ–¥–∞–∂': 'modules.SD',
                    '–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ': 'modules.PP',
                    '–∫–æ–Ω—Ç—Ä–æ–ª–ª–∏–Ω–≥': 'modules.CO'
                };
                
                for (const [keyword, topic] of Object.entries(generalTopics)) {
                    if (lowerQuestion.includes(keyword)) {
                        return this.generateTopicResponse(topic);
                    }
                }
                
                // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç
                return this.generateGeneralResponse(originalQuestion);
            }
            
            generateModuleResponse(module, question) {
                const moduleData = this.knowledgeBase.modules[module];
                let response = `üìä <strong>${module} - ${moduleData.description}</strong>\n\n`;
                
                response += `üìã <u>–û—Å–Ω–æ–≤–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:</u>\n`;
                let count = 0;
                for (const [tcode, desc] of Object.entries(moduleData.commonTransactions)) {
                    response += `‚Ä¢ <strong>${tcode}</strong> - ${desc}\n`;
                    count++;
                    if (count >= 10) {
                        response += `... –∏ –µ—â–µ ${Object.keys(moduleData.commonTransactions).length - count} —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π\n`;
                        break;
                    }
                }
                
                if (moduleData.bestPractices) {
                    response += `\nüí° <u>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</u>\n`;
                    moduleData.bestPractices.forEach(practice => {
                        response += `‚Ä¢ ${practice}\n`;
                    });
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç –ª–∏ –ø—Ä–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
                const words = question.split(' ');
                for (const word of words) {
                    if (word in moduleData.commonTransactions) {
                        response += `\nüîç <u>–î–µ—Ç–∞–ª–∏ –ø–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ ${word}:</u>\n`;
                        response += `${moduleData.commonTransactions[word]}\n`;
                        
                        // –î–æ–±–∞–≤–ª—è–µ–º —à–∞–≥–∏ –µ—Å–ª–∏ –µ—Å—Ç—å –≤ —à–∞–±–ª–æ–Ω–∞—Ö
                        const templateKey = Object.keys(this.knowledgeBase.templates[module] || {}).find(key => 
                            this.knowledgeBase.templates[module][key].some(step => step.includes(word))
                        );
                        
                        if (templateKey && this.knowledgeBase.templates[module][templateKey]) {
                            response += `\nüìù <u>–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:</u>\n`;
                            this.knowledgeBase.templates[module][templateKey].forEach((step, index) => {
                                response += `${index + 1}. ${step}\n`;
                            });
                        }
                        break;
                    }
                }
                
                response += `\n‚ùì <em>–ß—Ç–æ –∏–º–µ–Ω–Ω–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –≤ –º–æ–¥—É–ª–µ ${module}?</em>`;
                
                return response;
            }
            
            generateTransactionResponse(transaction) {
                // –ò—â–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤–æ –≤—Å–µ—Ö –º–æ–¥—É–ª—è—Ö
                for (const [module, data] of Object.entries(this.knowledgeBase.modules)) {
                    if (transaction in data.commonTransactions) {
                        let response = `üîç <strong>–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è ${transaction}</strong>\n`;
                        response += `üìå <u>–ú–æ–¥—É–ª—å:</u> ${module} - ${data.description}\n\n`;
                        response += `üìã <u>–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:</u> ${data.commonTransactions[transaction]}\n`;
                        
                        // –ò—â–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
                        if (this.knowledgeBase.templates[module]) {
                            for (const [templateName, steps] of Object.entries(this.knowledgeBase.templates[module])) {
                                if (steps.some(step => step.includes(transaction))) {
                                    response += `\nüìù <u>–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:</u>\n`;
                                    steps.forEach((step, index) => {
                                        response += `${index + 1}. ${step}\n`;
                                    });
                                    break;
                                }
                            }
                        }
                        
                        // –î–æ–±–∞–≤–ª—è–µ–º —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
                        response += `\nüîó <u>–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:</u>\n`;
                        const related = Object.entries(data.commonTransactions)
                            .filter(([t,]) => t !== transaction)
                            .slice(0, 5);
                        
                        related.forEach(([tcode, desc]) => {
                            response += `‚Ä¢ ${tcode} - ${desc}\n`;
                        });
                        
                        return response;
                    }
                }
                
                // –ï—Å–ª–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
                return `‚ùì –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è <strong>${transaction}</strong> –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π.\n`
                     + `–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∏–ª–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ SAP.`;
            }
            
            generateInstructionTemplate(question) {
                const lowerQuestion = question.toLowerCase();
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º–æ–¥—É–ª—å –∏–∑ –≤–æ–ø—Ä–æ—Å–∞
                let targetModule = null;
                for (const [module, data] of Object.entries(this.knowledgeBase.modules)) {
                    if (lowerQuestion.includes(module.toLowerCase()) || 
                        lowerQuestion.includes(data.description.toLowerCase().split(' ')[0])) {
                        targetModule = module;
                        break;
                    }
                }
                
                if (!targetModule || !this.knowledgeBase.templates[targetModule]) {
                    return this.suggestInstructionTemplate(question);
                }
                
                // –ò—â–µ–º –ø–æ–¥—Ö–æ–¥—è—â–∏–π —à–∞–±–ª–æ–Ω
                const templates = this.knowledgeBase.templates[targetModule];
                for (const [templateName, steps] of Object.entries(templates)) {
                    if (lowerQuestion.includes(templateName.toLowerCase())) {
                        let response = `üìù <strong>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: ${templateName}</strong>\n`;
                        response += `üìå <u>–ú–æ–¥—É–ª—å:</u> ${targetModule}\n\n`;
                        response += `üìã <u>–®–∞–≥–∏:</u>\n`;
                        steps.forEach((step, index) => {
                            response += `${index + 1}. ${step}\n`;
                        });
                        
                        response += `\nüí° <em>–°–æ–≤–µ—Ç:</em> –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ–æ—Ä–º—ã –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "AI –ì–µ–Ω–µ—Ä–∞—Ü–∏—è"`;
                        return response;
                    }
                }
                
                return this.suggestInstructionTemplate(question);
            }
            
            suggestInstructionTemplate(question) {
                let response = `ü§î <strong>–Ø –º–æ–≥—É –ø–æ–º–æ—á—å —Å–æ–∑–¥–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –¥–ª—è:</strong>\n\n`;
                
                const suggestions = [
                    '–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –Ω–∞ –∑–∞–∫—É–ø–∫—É (MM)',
                    '–í–≤–æ–¥ —Å—á–µ—Ç–∞ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ (FI)',
                    '–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –∫–ª–∏–µ–Ω—Ç–∞ (SD)',
                    '–ó–∞–ø—É—Å–∫ MRP (PP)',
                    '–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç (CO)',
                    '–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ (MM)',
                    '–ü—Ä–æ–≤–æ–¥–∫–∞ –ø–ª–∞—Ç–µ–∂–∞ (FI)',
                    '–°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–≥—Ä—É–∑–∫–∏ (SD)'
                ];
                
                suggestions.forEach((suggestion, index) => {
                    response += `${index + 1}. ${suggestion}\n`;
                });
                
                response += `\nüìå <em>–£—Ç–æ—á–Ω–∏—Ç–µ, –∫–∞–∫–∞—è –∏–º–µ–Ω–Ω–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –≤–∞–º –Ω—É–∂–Ω–∞?</em>`;
                return response;
            }
            
            generateTroubleshootingResponse(question) {
                const lowerQuestion = question.toLowerCase();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏
                for (const [error, solution] of Object.entries(this.knowledgeBase.commonErrors)) {
                    if (lowerQuestion.includes(error.toLowerCase())) {
                        return `‚ö†Ô∏è <strong>–†–µ—à–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ ${error}:</strong>\n\n${solution}\n\n`
                             + `üìå <em>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:</em>\n`
                             + `1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏—Å—Ç–µ–º–Ω—ã–π –ª–æ–≥ (SM21)\n`
                             + `2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∫–æ—Ä–æ—Ç–∫–∏–π –¥–∞–º–ø (ST22)\n`
                             + `3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (SU53)`;
                    }
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–æ–±–ª–µ–º
                for (const [category, solutions] of Object.entries(this.knowledgeBase.troubleshooting)) {
                    if (lowerQuestion.includes(category.toLowerCase())) {
                        let response = `üîß <strong>–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å ${category}:</strong>\n\n`;
                        solutions.forEach((solution, index) => {
                            response += `${index + 1}. ${solution}\n`;
                        });
                        return response;
                    }
                }
                
                // –û–±—â–∏–π —Å–æ–≤–µ—Ç –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é –Ω–µ–ø–æ–ª–∞–¥–æ–∫
                return `üîß <strong>–û–±—â–∏–µ —à–∞–≥–∏ –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é –Ω–µ–ø–æ–ª–∞–¥–æ–∫:</strong>\n\n`
                     + `1. <strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—à–∏–±–∫—É</strong> - —Ç–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (SM21)\n`
                     + `2. <strong>–ê–Ω–∞–ª–∏–∑ –¥–∞–º–ø–∞</strong> - –µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ—Ä–æ—Ç–∫–∏–π –¥–∞–º–ø (ST22)\n`
                     + `3. <strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏</strong> - —Å–∏—Å—Ç–µ–º–Ω—ã–π –ª–æ–≥ –∏ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è\n`
                     + `4. <strong>–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–∏—Ç–µ</strong> - –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –æ—à–∏–±–∫—É\n`
                     + `5. <strong>–ò–∑–æ–ª–∏—Ä—É–π—Ç–µ</strong> - –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç–æ—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è\n`
                     + `6. <strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ</strong> - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤–≤–æ–¥–∏–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö\n`
                     + `7. <strong>–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞</strong> - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é (SU53)\n\n`
                     + `üìå <em>–û–ø–∏—à–∏—Ç–µ —Ç–æ—á–Ω—É—é –æ—à–∏–±–∫—É –¥–ª—è –±–æ–ª–µ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–æ–º–æ—â–∏</em>`;
            }
            
            generateTopicResponse(topicPath) {
                const [type, category] = topicPath.split('.');
                
                if (type === 'troubleshooting') {
                    const solutions = this.knowledgeBase.troubleshooting[category];
                    let response = `üìö <strong>${category} –≤ SAP:</strong>\n\n`;
                    solutions.forEach((solution, index) => {
                        response += `${index + 1}. ${solution}\n`;
                    });
                    return response;
                }
                
                if (type === 'modules') {
                    return this.generateModuleResponse(category, '');
                }
                
                return '–ó–∞–ø—Ä–æ—à–µ–Ω–Ω–∞—è —Ç–µ–º–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π.';
            }
            
            generateGeneralResponse(question) {
                // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
                const lastAssistantMessage = this.conversationHistory
                    .filter(msg => msg.role === 'assistant')
                    .slice(-1)[0];
                
                if (lastAssistantMessage) {
                    if (question.toLowerCase().includes('—Å–ø–∞—Å–∏–±–æ') || question.toLowerCase().includes('–±–ª–∞–≥–æ–¥–∞—Ä—é')) {
                        return '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞! üòä –†–∞–¥ –±—ã–ª –ø–æ–º–æ—á—å. –ï—Å–ª–∏ –±—É–¥—É—Ç –µ—â–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ SAP - –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å!';
                    }
                    
                    if (question.toLowerCase().includes('–ø—Ä–∏–≤–µ—Ç') || question.toLowerCase().includes('–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π')) {
                        return '–ü—Ä–∏–≤–µ—Ç! üëã –Ø SAP Assistant - –≤–∞—à —ç–∫—Å–ø–µ—Ä—Ç –ø–æ —Å–∏—Å—Ç–µ–º–µ SAP. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?';
                    }
                }
                
                // –û–±—â–∏–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
                const responses = [
                    `ü§î <strong>–Ø –≤–∏–∂—É –≤–∞—à –≤–æ–ø—Ä–æ—Å: "${question}"</strong>\n\n`
                    + `–Ø –º–æ–≥—É –ø–æ–º–æ—á—å —Å:\n`
                    + `‚Ä¢ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –ø–æ –º–æ–¥—É–ª—è–º SAP (FI, MM, SD, PP, CO –∏ –¥—Ä.)\n`
                    + `‚Ä¢ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –∏ –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ–º\n`
                    + `‚Ä¢ –°–æ–∑–¥–∞–Ω–∏–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π\n`
                    + `‚Ä¢ –†–µ—à–µ–Ω–∏–µ–º —Ç–∏–ø–æ–≤—ã—Ö –ø—Ä–æ–±–ª–µ–º\n`
                    + `‚Ä¢ –õ—É—á—à–∏–º–∏ –ø—Ä–∞–∫—Ç–∏–∫–∞–º–∏\n\n`
                    + `<em>–£—Ç–æ—á–Ω–∏—Ç–µ, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?</em>`,
                    
                    `üí° <strong>–ü–æ–¥—Å–∫–∞–∑–∫–∞:</strong> –ó–∞–¥–∞–≤–∞–π—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä:\n\n`
                    + `‚Ä¢ "–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ –Ω–∞ –∑–∞–∫—É–ø–∫—É?"\n`
                    + `‚Ä¢ "–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è FB01?"\n`
                    + `‚Ä¢ "–ü—Ä–æ–±–ª–µ–º–∞ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π –≤ SAP"\n`
                    + `‚Ä¢ "–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—é —Ç–æ–≤–∞—Ä–æ–≤"\n`
                    + `‚Ä¢ "–û—Å–Ω–æ–≤–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –º–æ–¥—É–ª—è MM"`,
                    
                    `üìö <strong>–≠–∫—Å–ø–µ—Ä—Ç–∏–∑–∞ –ø–æ SAP:</strong>\n\n`
                    + `–Ø –æ–±–ª–∞–¥–∞—é –≥–ª—É–±–æ–∫–∏–º–∏ –∑–Ω–∞–Ω–∏—è–º–∏ –ø–æ:\n`
                    + `‚Ä¢ –§–∏–Ω–∞–Ω—Å–æ–≤–æ–º—É —É—á–µ—Ç—É (FI)\n`
                    + `‚Ä¢ –£–ø—Ä–∞–≤–ª–µ–Ω–∏—é –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏ (MM)\n`
                    + `‚Ä¢ –ü—Ä–æ–¥–∞–∂–∞–º –∏ –¥–∏—Å—Ç—Ä–∏–±—É—Ü–∏–∏ (SD)\n`
                    + `‚Ä¢ –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É (PP)\n`
                    + `‚Ä¢ –ö–æ–Ω—Ç—Ä–æ–ª–ª–∏–Ω–≥—É (CO)\n`
                    + `‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–µ (BASIS)\n\n`
                    + `<em>–°–ø—Ä–æ—Å–∏—Ç–µ –º–µ–Ω—è –æ —á–µ–º —É–≥–æ–¥–Ω–æ –≤ —ç—Ç–∏—Ö –æ–±–ª–∞—Å—Ç—è—Ö!</em>`
                ];
                
                return responses[Math.floor(Math.random() * responses.length)];
            }
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥–æ—Ç–æ–≤–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Ñ–æ—Ä–º—ã
            generateCompleteInstruction(topic) {
                const lowerTopic = topic.toLowerCase();
                
                // –ò—â–µ–º –ø–æ–¥—Ö–æ–¥—è—â–∏–π —à–∞–±–ª–æ–Ω
                for (const [module, templates] of Object.entries(this.knowledgeBase.templates)) {
                    for (const [templateName, steps] of Object.entries(templates)) {
                        if (lowerTopic.includes(templateName.toLowerCase()) || 
                            lowerTopic.includes(module.toLowerCase())) {
                            
                            const moduleInfo = this.knowledgeBase.modules[module];
                            const transaction = steps.find(step => step.match(/\b[A-Z]{1,4}\d{1,4}[A-Z]?\b/));
                            const tcode = transaction ? transaction.match(/\b([A-Z]{1,4}\d{1,4}[A-Z]?)\b/)[1] : '';
                            
                            return {
                                title: `–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: ${templateName}`,
                                module: module,
                                transactionCode: tcode,
                                steps: steps,
                                tags: this.generateTagsForModule(module),
                                notes: `–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ SAP AI Assistant\n–ú–æ–¥—É–ª—å: ${module}\n${moduleInfo.description}`
                            };
                        }
                    }
                }
                
                // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ —Ç–æ—á–Ω—ã–π —à–∞–±–ª–æ–Ω
                return {
                    title: `–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: ${topic}`,
                    module: 'FI', // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
                    transactionCode: '',
                    steps: [
                        '–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É SAP',
                        '–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é',
                        '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è',
                        '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–≤–µ–¥–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ',
                        '–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç',
                        '–ó–∞–ø–∏—à–∏—Ç–µ –Ω–æ–º–µ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è'
                    ],
                    tags: ['sap', '–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è', '—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ'],
                    notes: '–°–æ–∑–¥–∞–Ω–æ SAP AI Assistant. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —à–∞–≥–∏ –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∑–∞–¥–∞—á—É.'
                };
            }
            
            generateTagsForModule(module) {
                const tags = {
                    'FI': ['—Ñ–∏–Ω–∞–Ω—Å—ã', '–±—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è', '–ø—Ä–æ–≤–æ–¥–∫–∞', '–¥–æ–∫—É–º–µ–Ω—Ç', '—Å—á–µ—Ç'],
                    'MM': ['–º–∞—Ç–µ—Ä–∏–∞–ª—ã', '–∑–∞–∫—É–ø–∫–∏', '—Å–∫–ª–∞–¥', '–∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è', '–ø–æ—Å—Ç–∞–≤—â–∏–∫'],
                    'SD': ['–ø—Ä–æ–¥–∞–∂–∏', '–¥–∏—Å—Ç—Ä–∏–±—É—Ü–∏—è', '–∫–ª–∏–µ–Ω—Ç', '–æ—Ç–≥—Ä—É–∑–∫–∞', '–∑–∞–∫–∞–∑'],
                    'PP': ['–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ', '–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ', 'mrp', '–∑–∞–∫–∞–∑', '–æ–ø–µ—Ä–∞—Ü–∏—è'],
                    'CO': ['–∫–æ–Ω—Ç—Ä–æ–ª–ª–∏–Ω–≥', '–∑–∞—Ç—Ä–∞—Ç—ã', '—Ü–µ–Ω—Ç—Ä –ø—Ä–∏–±—ã–ª–∏', '–∞–Ω–∞–ª–∏–∑', '–æ—Ç—á–µ—Ç'],
                    'QM': ['–∫–∞—á–µ—Å—Ç–≤–æ', '–∏–Ω—Å–ø–µ–∫—Ü–∏—è', '—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ', '—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è'],
                    'PM': ['–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ', '—Ä–µ–º–æ–Ω—Ç', '–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ', '–ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞'],
                    'HR': ['–∫–∞–¥—Ä—ã', '–ø–µ—Ä—Å–æ–Ω–∞–ª', '–∑–∞—Ä–ø–ª–∞—Ç–∞', '–æ—Ç–ø—É—Å–∫', '—à—Ç–∞—Ç–Ω–æ–µ']
                };
                
                return tags[module] || ['sap', '–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è'];
            }
        }

        // –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä AI —ç–∫—Å–ø–µ—Ä—Ç–∞
        const sapAI = new SAPAIExpert();

        // –ú–æ–¥—É–ª–∏ SAP —Å –∏–∫–æ–Ω–∫–∞–º–∏
        const sapModules = [
            { id: 'FI', name: '–§–∏–Ω–∞–Ω—Å—ã (FI)', icon: 'fa-coins', color: '#4CAF50' },
            { id: 'CO', name: '–ö–æ–Ω—Ç—Ä–æ–ª–ª–∏–Ω–≥ (CO)', icon: 'fa-chart-line', color: '#2196F3' },
            { id: 'MM', name: '–ú–∞—Ç–µ—Ä–∏–∞–ª—ã (MM)', icon: 'fa-boxes', color: '#FF9800' },
            { id: 'SD', name: '–ü—Ä–æ–¥–∞–∂–∏ (SD)', icon: 'fa-shopping-cart', color: '#E91E63' },
            { id: 'PP', name: '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ (PP)', icon: 'fa-industry', color: '#9C27B0' },
            { id: 'QM', name: '–ö–∞—á–µ—Å—Ç–≤–æ (QM)', icon: 'fa-check-double', color: '#009688' },
            { id: 'PM', name: '–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ (PM)', icon: 'fa-tools', color: '#795548' },
            { id: 'HR', name: '–ö–∞–¥—Ä—ã (HR)', icon: 'fa-users', color: '#3F51B5' },
            { id: 'PS', name: '–ü—Ä–æ–µ–∫—Ç—ã (PS)', icon: 'fa-project-diagram', color: '#00BCD4' },
            { id: 'WM', name: '–°–∫–ª–∞–¥ (WM)', icon: 'fa-warehouse', color: '#8BC34A' },
            { id: 'BASIS', name: '–ë–∞–∑–∏—Å (BASIS)', icon: 'fa-server', color: '#607D8B' }
        ];

        // ===================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====================
        function initializeApp() {
            console.log('Initializing app...');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
            const savedUser = localStorage.getItem('sapAssistantUser');
            console.log('Saved user from localStorage:', savedUser);
            
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    console.log('Parsed user:', currentUser);
                    startApplication();
                } catch (error) {
                    console.error('Error parsing saved user:', error);
                    // –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º welcome screen
                    showWelcomeScreen();
                }
            } else {
                showWelcomeScreen();
            }
        }

        function showWelcomeScreen() {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º welcome screen
            const welcomeScreen = document.getElementById('welcomeScreen');
            const app = document.getElementById('app');
            
            if (welcomeScreen && app) {
                welcomeScreen.style.display = 'flex';
                app.style.display = 'none';
                
                // –§–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞
                const userNameInput = document.getElementById('userNameInput');
                if (userNameInput) {
                    userNameInput.focus();
                    
                    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è Enter –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
                    userNameInput.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter') {
                            console.log('Enter pressed in username input');
                            startWithUserName();
                        }
                    });
                }
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –Ω–∞ –∫–Ω–æ–ø–∫—É —Å—Ç–∞—Ä—Ç–∞
                const startButton = document.getElementById('startButton');
                if (startButton) {
                    startButton.addEventListener('click', startWithUserName);
                }
                
                console.log('Welcome screen shown');
            } else {
                console.error('Welcome screen elements not found!');
            }
        }

        function startWithUserName() {
            console.log('startWithUserName called');
            
            const userName = document.getElementById('userNameInput').value.trim();
            
            console.log('Start button clicked, username:', userName);
            
            if (!userName) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è', 'error');
                document.getElementById('userNameInput').focus();
                return;
            }
            
            // –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            currentUser = {
                id: generateId(),
                name: userName,
                avatar: userName.charAt(0).toUpperCase(),
                createdAt: new Date().toISOString(),
                settings: {
                    autoSave: true,
                    theme: 'light',
                    tutorialCompleted: false
                }
            };
            
            console.log('Created user:', currentUser);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            localStorage.setItem('sapAssistantUser', JSON.stringify(currentUser));
            console.log('User saved to localStorage');
            
            // –°–æ–∑–¥–∞–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            initializeUserStorage();
            
            startApplication();
        }

        function startApplication() {
            console.log('Starting application...');
            
            // –°–∫—Ä—ã–≤–∞–µ–º welcome screen
            const welcomeScreen = document.getElementById('welcomeScreen');
            const app = document.getElementById('app');
            
            if (!welcomeScreen || !app) {
                console.error('Elements not found!');
                return;
            }
            
            welcomeScreen.style.display = 'none';
            app.style.display = 'block';
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('userAvatar').textContent = currentUser.avatar;
            document.getElementById('changeUserName').value = currentUser.name;
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            loadUserData();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            initializeModules();
            updateStats();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º tutorial –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
            if (!currentUser.settings.tutorialCompleted) {
                setTimeout(() => showTutorial(), 1000);
            }
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
            setupAutoSave();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showNotification(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${currentUser.name}!`, 'success');
            console.log('Application started successfully');
        }

        function initializeUserStorage() {
            const userKey = `sapAssistantData_${currentUser.id}`;
            if (!localStorage.getItem(userKey)) {
                const initialData = {
                    instructions: [],
                    favorites: [],
                    recent: [],
                    backups: [],
                    version: '1.0'
                };
                localStorage.setItem(userKey, JSON.stringify(initialData));
                console.log('Initial user storage created');
            }
        }

        function loadUserData() {
            const userKey = `sapAssistantData_${currentUser.id}`;
            const userData = JSON.parse(localStorage.getItem(userKey) || '{}');
            
            instructions = userData.instructions || [];
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            document.getElementById('autoSave').value = currentUser.settings.autoSave;
            document.getElementById('themeSelect').value = currentUser.settings.theme;
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É
            applyTheme(currentUser.settings.theme);
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
            displayInstructions();
            
            console.log('User data loaded:', instructions.length, 'instructions');
        }

        function saveUserData() {
            const userKey = `sapAssistantData_${currentUser.id}`;
            const userData = {
                instructions: instructions,
                favorites: instructions.filter(i => i.isFavorite),
                recent: getRecentInstructions(),
                backups: [],
                lastUpdated: new Date().toISOString(),
                version: '1.0'
            };
            
            localStorage.setItem(userKey, JSON.stringify(userData));
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            currentUser.settings.autoSave = document.getElementById('autoSave').value === 'true';
            currentUser.settings.theme = document.getElementById('themeSelect').value;
            localStorage.setItem('sapAssistantUser', JSON.stringify(currentUser));
            
            console.log('User data saved');
        }

        // ===================== –ò–ù–¢–ï–†–§–ï–ô–° =====================
        function initializeModules() {
            const moduleList = document.getElementById('moduleList');
            const moduleFilter = document.getElementById('moduleFilter');
            
            moduleList.innerHTML = '';
            moduleFilter.innerHTML = '<option value="">–í—Å–µ –º–æ–¥—É–ª–∏</option>';
            
            sapModules.forEach(module => {
                // –î–ª—è sidebar
                const li = document.createElement('li');
                li.className = 'nav-item';
                li.innerHTML = `
                    <a href="#" class="nav-link" onclick="filterByModule('${module.id}')">
                        <i class="fas ${module.icon}" style="color: ${module.color};"></i>
                        ${module.name}
                    </a>
                `;
                moduleList.appendChild(li);
                
                // –î–ª—è —Ñ–∏–ª—å—Ç—Ä–∞
                const option = document.createElement('option');
                option.value = module.id;
                option.textContent = module.name;
                moduleFilter.appendChild(option);
            });
        }

        function displayInstructions(filteredInstructions = null) {
            const grid = document.getElementById('instructionsGrid');
            const emptyState = document.getElementById('emptyState');
            
            const instructionsToShow = filteredInstructions || getFilteredInstructions();
            
            if (instructionsToShow.length === 0) {
                grid.style.display = 'none';
                emptyState.style.display = 'block';
                return;
            }
            
            grid.style.display = 'grid';
            emptyState.style.display = 'none';
            
            grid.innerHTML = '';
            
            instructionsToShow.forEach(instruction => {
                const card = createInstructionCard(instruction);
                grid.appendChild(card);
            });
            
            updateStats();
        }

        function createInstructionCard(instruction) {
            const card = document.createElement('div');
            card.className = 'card';
            card.dataset.id = instruction.id;
            
            const moduleInfo = sapModules.find(m => m.id === instruction.module) || sapModules[0];
            const stepsPreview = instruction.steps.slice(0, 3).map((step, i) => `${i + 1}. ${step}`).join('<br>');
            
            card.innerHTML = `
                <div class="card-header">
                    <div class="card-module" style="background-color: ${moduleInfo.color}20; color: ${moduleInfo.color};">
                        <i class="fas ${moduleInfo.icon}"></i> ${moduleInfo.name}
                    </div>
                    <div class="card-title">
                        ${instruction.title}
                        <span style="font-size: 14px; color: ${instruction.isFavorite ? '#FFC107' : '#ccc'};">
                            <i class="fas fa-star"></i>
                        </span>
                    </div>
                    ${instruction.transactionCode ? `
                        <div class="card-transaction">
                            <i class="fas fa-code"></i> ${instruction.transactionCode}
                        </div>
                    ` : ''}
                </div>
                <div class="card-body">
                    <div class="card-steps">${stepsPreview}</div>
                    ${instruction.tags && instruction.tags.length > 0 ? `
                        <div class="card-tags">
                            ${instruction.tags.slice(0, 3).map(tag => `
                                <span class="tag">${tag.trim()}</span>
                            `).join('')}
                            ${instruction.tags.length > 3 ? `<span class="tag">+${instruction.tags.length - 3}</span>` : ''}
                        </div>
                    ` : ''}
                    ${instruction.media && instruction.media.length > 0 ? `
                        <div style="font-size: 12px; color: var(--sap-gray); margin-top: 10px;">
                            <i class="fas fa-paperclip"></i> ${instruction.media.length} –≤–ª–æ–∂–µ–Ω–∏–µ
                        </div>
                    ` : ''}
                </div>
                <div class="card-footer">
                    <div style="font-size: 12px; color: var(--sap-gray);">
                        <i class="far fa-clock"></i> ${formatDate(instruction.updatedAt)}
                    </div>
                    <div class="card-actions">
                        <button class="action-btn" onclick="event.stopPropagation(); toggleFavorite('${instruction.id}')" title="${instruction.isFavorite ? '–£–±—Ä–∞—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ' : '–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ'}">
                            <i class="fas ${instruction.isFavorite ? 'fa-star' : 'fa-star'}"></i>
                        </button>
                        <button class="action-btn" onclick="event.stopPropagation(); editInstruction('${instruction.id}')" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn" onclick="event.stopPropagation(); deleteInstruction('${instruction.id}')" title="–£–¥–∞–ª–∏—Ç—å">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `;
            
            card.addEventListener('click', (e) => {
                if (!e.target.closest('.card-actions')) {
                    viewInstruction(instruction.id);
                }
            });
            
            return card;
        }

        function showSection(section) {
            currentSection = section;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ —Å—Å—ã–ª–∫–∏
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            document.querySelector(`[onclick="showSection('${section}')"]`).classList.add('active');
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä
            displayInstructions();
        }

        function getFilteredInstructions() {
            let filtered = [...instructions];
            
            // –§–∏–ª—å—Ç—Ä –ø–æ —Å–µ–∫—Ü–∏–∏
            switch (currentSection) {
                case 'favorites':
                    filtered = filtered.filter(i => i.isFavorite);
                    break;
                case 'recent':
                    filtered = filtered.sort((a, b) => 
                        new Date(b.updatedAt) - new Date(a.updatedAt)
                    ).slice(0, 20);
                    break;
            }
            
            // –§–∏–ª—å—Ç—Ä –ø–æ –º–æ–¥—É–ª—é
            if (currentFilter) {
                filtered = filtered.filter(i => i.module === currentFilter);
            }
            
            return filtered;
        }

        // ===================== CRUD –û–ü–ï–†–ê–¶–ò–ò =====================
        function showNewInstructionModal() {
            document.getElementById('modalTitle').textContent = '–ù–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è';
            document.getElementById('instructionForm').reset();
            document.getElementById('instructionId').value = '';
            document.getElementById('stepsContainer').innerHTML = `
                <div class="steps-container">
                    <input type="text" class="form-control step-input" placeholder="–®–∞–≥ 1">
                    <button type="button" class="btn btn-icon" onclick="addStep()">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
            `;
            document.getElementById('mediaContainer').innerHTML = '';
            
            showModal();
        }

        function showModal() {
            document.getElementById('instructionModal').classList.add('active');
        }

        function hideModal() {
            document.getElementById('instructionModal').classList.remove('active');
        }

        function addStep() {
            const container = document.getElementById('stepsContainer');
            const stepCount = container.querySelectorAll('.steps-container').length + 1;
            
            const stepDiv = document.createElement('div');
            stepDiv.className = 'steps-container';
            stepDiv.innerHTML = `
                <input type="text" class="form-control step-input" placeholder="–®–∞–≥ ${stepCount}">
                <button type="button" class="btn btn-icon" onclick="removeStep(this)">
                    <i class="fas fa-minus"></i>
                </button>
            `;
            
            container.appendChild(stepDiv);
        }

        function removeStep(button) {
            const container = document.getElementById('stepsContainer');
            if (container.querySelectorAll('.steps-container').length > 1) {
                button.closest('.steps-container').remove();
                renumberSteps();
            }
        }

        function renumberSteps() {
            const steps = document.querySelectorAll('.step-input');
            steps.forEach((input, index) => {
                input.placeholder = `–®–∞–≥ ${index + 1}`;
            });
        }

        function addMedia() {
            const urlInput = document.getElementById('mediaInput');
            const url = urlInput.value.trim();
            
            if (!url || !isValidUrl(url)) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π URL', 'error');
                return;
            }
            
            const container = document.getElementById('mediaContainer');
            const mediaId = generateId();
            
            const mediaTag = document.createElement('div');
            mediaTag.className = 'media-tag';
            mediaTag.innerHTML = `
                <i class="fas fa-link"></i> ${truncateText(url, 30)}
                <button type="button" onclick="removeMedia('${mediaId}')" style="background: none; border: none; color: var(--sap-blue); cursor: pointer;">
                    <i class="fas fa-times"></i>
                </button>
            `;
            mediaTag.dataset.url = url;
            mediaTag.dataset.id = mediaId;
            
            container.appendChild(mediaTag);
            urlInput.value = '';
        }

        function removeMedia(id) {
            const element = document.querySelector(`[data-id="${id}"]`);
            if (element) {
                element.remove();
            }
        }

        function saveInstruction() {
            const id = document.getElementById('instructionId').value;
            const title = document.getElementById('instructionTitle').value.trim();
            const module = document.getElementById('instructionModule').value;
            const transactionCode = document.getElementById('transactionCode').value.trim();
            const tags = document.getElementById('instructionTags').value.split(',').map(t => t.trim()).filter(t => t);
            const notes = document.getElementById('instructionNotes').value.trim();
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è
            if (!title || !module) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            // –°–æ–±–∏—Ä–∞–µ–º —à–∞–≥–∏
            const steps = Array.from(document.querySelectorAll('.step-input'))
                .map(input => input.value.trim())
                .filter(step => step);
            
            if (steps.length === 0) {
                showNotification('–î–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —à–∞–≥', 'error');
                return;
            }
            
            // –°–æ–±–∏—Ä–∞–µ–º –º–µ–¥–∏–∞
            const media = Array.from(document.querySelectorAll('.media-tag'))
                .map(tag => tag.dataset.url);
            
            const instructionData = {
                id: id || generateId(),
                title,
                module,
                transactionCode,
                steps,
                media,
                tags,
                notes,
                isFavorite: false,
                createdAt: id ? instructions.find(i => i.id === id)?.createdAt || new Date().toISOString() : new Date().toISOString(),
                updatedAt: new Date().toISOString(),
                userId: currentUser.id,
                views: id ? instructions.find(i => i.id === id)?.views || 0 : 0
            };
            
            if (id) {
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
                const index = instructions.findIndex(i => i.id === id);
                if (index !== -1) {
                    instructionData.isFavorite = instructions[index].isFavorite;
                    instructionData.views = instructions[index].views;
                    instructions[index] = instructionData;
                }
            } else {
                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
                instructions.push(instructionData);
            }
            
            saveUserData();
            displayInstructions();
            hideModal();
            
            showNotification(`–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è "${title}" —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞`, 'success');
        }

        function editInstruction(id) {
            const instruction = instructions.find(i => i.id === id);
            if (!instruction) return;
            
            document.getElementById('modalTitle').textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é';
            document.getElementById('instructionId').value = instruction.id;
            document.getElementById('instructionTitle').value = instruction.title;
            document.getElementById('instructionModule').value = instruction.module;
            document.getElementById('transactionCode').value = instruction.transactionCode || '';
            document.getElementById('instructionTags').value = instruction.tags ? instruction.tags.join(', ') : '';
            document.getElementById('instructionNotes').value = instruction.notes || '';
            
            // –®–∞–≥–∏
            const stepsContainer = document.getElementById('stepsContainer');
            stepsContainer.innerHTML = '';
            instruction.steps.forEach((step, index) => {
                const stepDiv = document.createElement('div');
                stepDiv.className = 'steps-container';
                stepDiv.innerHTML = `
                    <input type="text" class="form-control step-input" value="${step}" placeholder="–®–∞–≥ ${index + 1}">
                    ${index === 0 ? 
                        '<button type="button" class="btn btn-icon" onclick="addStep()"><i class="fas fa-plus"></i></button>' :
                        '<button type="button" class="btn btn-icon" onclick="removeStep(this)"><i class="fas fa-minus"></i></button>'
                    }
                `;
                stepsContainer.appendChild(stepDiv);
            });
            
            // –ú–µ–¥–∏–∞
            const mediaContainer = document.getElementById('mediaContainer');
            mediaContainer.innerHTML = '';
            instruction.media.forEach(url => {
                const mediaId = generateId();
                const mediaTag = document.createElement('div');
                mediaTag.className = 'media-tag';
                mediaTag.innerHTML = `
                    <i class="fas fa-link"></i> ${truncateText(url, 30)}
                    <button type="button" onclick="removeMedia('${mediaId}')" style="background: none; border: none; color: var(--sap-blue); cursor: pointer;">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                mediaTag.dataset.url = url;
                mediaTag.dataset.id = mediaId;
                mediaContainer.appendChild(mediaTag);
            });
            
            showModal();
        }

        function viewInstruction(id) {
            const instruction = instructions.find(i => i.id === id);
            if (!instruction) return;
            
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
            instruction.views = (instruction.views || 0) + 1;
            instruction.updatedAt = new Date().toISOString();
            saveUserData();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–º
            document.getElementById('modalTitle').textContent = instruction.title;
            document.getElementById('instructionId').value = instruction.id;
            
            const moduleInfo = sapModules.find(m => m.id === instruction.module) || sapModules[0];
            
            const modalBody = document.createElement('div');
            modalBody.className = 'modal-body';
            modalBody.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 30px;">
                    <div>
                        <span class="card-module" style="background-color: ${moduleInfo.color}20; color: ${moduleInfo.color};">
                            <i class="fas ${moduleInfo.icon}"></i> ${moduleInfo.name}
                        </span>
                        ${instruction.transactionCode ? `
                            <div style="margin-top: 10px;">
                                <strong>–ö–æ–¥ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:</strong> ${instruction.transactionCode}
                            </div>
                        ` : ''}
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 14px; color: var(--sap-gray);">
                            <i class="far fa-eye"></i> ${instruction.views} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
                        </div>
                        <div style="font-size: 14px; color: var(--sap-gray); margin-top: 5px;">
                            <i class="far fa-clock"></i> ${formatDate(instruction.updatedAt)}
                        </div>
                    </div>
                </div>
                
                <div style="margin-bottom: 25px;">
                    <h3 style="margin-bottom: 15px; color: #32363A;">–®–∞–≥–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:</h3>
                    <ol style="padding-left: 20px;">
                        ${instruction.steps.map((step, index) => `
                            <li style="margin-bottom: 10px; padding-left: 10px;">${step}</li>
                        `).join('')}
                    </ol>
                </div>
                
                ${instruction.notes ? `
                    <div style="margin-bottom: 25px;">
                        <h3 style="margin-bottom: 15px; color: #32363A;">–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:</h3>
                        <div style="background: var(--sap-gray-light); padding: 15px; border-radius: var(--radius);">
                            ${instruction.notes}
                        </div>
                    </div>
                ` : ''}
                
                ${instruction.tags && instruction.tags.length > 0 ? `
                    <div style="margin-bottom: 25px;">
                        <h3 style="margin-bottom: 15px; color: #32363A;">–¢–µ–≥–∏:</h3>
                        <div class="card-tags">
                            ${instruction.tags.map(tag => `
                                <span class="tag">${tag}</span>
                            `).join('')}
                        </div>
                    </div>
                ` : ''}
                
                ${instruction.media && instruction.media.length > 0 ? `
                    <div>
                        <h3 style="margin-bottom: 15px; color: #32363A;">–ú–µ–¥–∏–∞—Ñ–∞–π–ª—ã:</h3>
                        <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                            ${instruction.media.map(url => `
                                <a href="${url}" target="_blank" class="media-tag" style="text-decoration: none;">
                                    <i class="fas fa-external-link-alt"></i> ${truncateText(url, 40)}
                                </a>
                            `).join('')}
                        </div>
                    </div>
                ` : ''}
            `;
            
            // –ó–∞–º–µ–Ω—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            const modalContent = document.querySelector('.modal-content');
            const oldBody = modalContent.querySelector('.modal-body');
            const footer = modalContent.querySelector('.modal-footer');
            
            oldBody.remove();
            modalContent.insertBefore(modalBody, footer);
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –≤ —Ñ—É—Ç–µ—Ä–µ
            footer.innerHTML = `
                <button class="btn" onclick="hideModal()">
                    <i class="fas fa-times"></i> –ó–∞–∫—Ä—ã—Ç—å
                </button>
                <button class="btn" onclick="editInstruction('${instruction.id}')">
                    <i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                </button>
                <button class="btn btn-success" onclick="toggleFavorite('${instruction.id}')">
                    <i class="fas ${instruction.isFavorite ? 'fa-star' : 'fa-star'}"></i>
                    ${instruction.isFavorite ? '–£–±—Ä–∞—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ' : '–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ'}
                </button>
            `;
            
            showModal();
        }

        function toggleFavorite(id) {
            const instruction = instructions.find(i => i.id === id);
            if (instruction) {
                instruction.isFavorite = !instruction.isFavorite;
                instruction.updatedAt = new Date().toISOString();
                saveUserData();
                displayInstructions();
                
                showNotification(
                    instruction.isFavorite ? '–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ' : '–£–±—Ä–∞–Ω–æ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ',
                    'info'
                );
            }
        }

        function deleteInstruction(id) {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é?')) return;
            
            instructions = instructions.filter(i => i.id !== id);
            saveUserData();
            displayInstructions();
            
            showNotification('–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∞', 'warning');
        }

        // ===================== –ü–û–ò–°–ö –ò –§–ò–õ–¨–¢–†–ê–¶–ò–Ø =====================
        function searchInstructions() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            
            if (!searchTerm) {
                displayInstructions();
                return;
            }
            
            const filtered = instructions.filter(instruction => 
                instruction.title.toLowerCase().includes(searchTerm) ||
                instruction.transactionCode?.toLowerCase().includes(searchTerm) ||
                instruction.tags?.some(tag => tag.toLowerCase().includes(searchTerm)) ||
                instruction.steps?.some(step => step.toLowerCase().includes(searchTerm)) ||
                instruction.notes?.toLowerCase().includes(searchTerm)
            );
            
            displayInstructions(filtered);
        }

        function filterByModule(moduleId = null) {
            if (moduleId === null) {
                moduleId = document.getElementById('moduleFilter').value;
            }
            
            currentFilter = moduleId;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫
            document.getElementById('moduleFilter').value = moduleId;
            
            displayInstructions();
        }

        // ===================== AI –ü–û–ú–û–©–ù–ò–ö =====================
        function handleCommand(command) {
            const cmd = command.toLowerCase().trim();
            
            if (cmd === '/help') {
                let response = '‚ö° <strong>–ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã:</strong>\n\n';
                const quickCommands = [
                    { cmd: '/help', desc: '–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–º–æ—â—å' },
                    { cmd: '/modules', desc: '–°–ø–∏—Å–æ–∫ –º–æ–¥—É–ª–µ–π SAP' },
                    { cmd: '/fi', desc: '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –º–æ–¥—É–ª—é FI' },
                    { cmd: '/mm', desc: '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –º–æ–¥—É–ª—é MM' },
                    { cmd: '/sd', desc: '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –º–æ–¥—É–ª—é SD' },
                    { cmd: '/tcode FB01', desc: '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏' },
                    { cmd: '/error MESSAGE', desc: '–†–µ—à–µ–Ω–∏–µ –æ—à–∏–±–æ–∫' }
                ];
                
                quickCommands.forEach(item => {
                    response += `<code>${item.cmd}</code> - ${item.desc}\n`;
                });
                response += '\nüìå <em>–ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –∑–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –æ–±—ã—á–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º</em>';
                return response;
            }
            
            if (cmd === '/modules') {
                let response = 'üìö <strong>–ú–æ–¥—É–ª–∏ SAP:</strong>\n\n';
                Object.entries(sapAI.knowledgeBase.modules).forEach(([module, data]) => {
                    response += `‚Ä¢ <strong>${module}</strong> - ${data.description}\n`;
                });
                return response;
            }
            
            if (cmd.startsWith('/tcode ')) {
                const tcode = cmd.replace('/tcode ', '').toUpperCase();
                return sapAI.generateTransactionResponse(tcode);
            }
            
            if (cmd.startsWith('/error ')) {
                const error = cmd.replace('/error ', '');
                return sapAI.generateTroubleshootingResponse(error);
            }
            
            const moduleCommands = ['/fi', '/mm', '/sd', '/pp', '/co', '/qm', '/pm', '/hr'];
            for (const moduleCmd of moduleCommands) {
                if (cmd === moduleCmd) {
                    const module = moduleCmd.replace('/', '').toUpperCase();
                    return sapAI.generateModuleResponse(module, '');
                }
            }
            
            return null;
        }

        function sendAIMessage() {
            const input = document.getElementById('aiInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–º–∞–Ω–¥—É
            if (message.startsWith('/')) {
                const commandResponse = handleCommand(message);
                if (commandResponse) {
                    addAIMessage(message, 'user');
                    addAIMessage(commandResponse, 'ai');
                    input.value = '';
                    return;
                }
            }
            
            // –û–±—ã—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
            addAIMessage(message, 'user');
            input.value = '';
            
            const loadingId = addAIMessage('üîç –ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –≤–æ–ø—Ä–æ—Å...', 'ai', true);
            
            setTimeout(async () => {
                try {
                    const response = await sapAI.processQuestion(message);
                    updateAIMessage(loadingId, response);
                } catch (error) {
                    console.error('AI Error:', error);
                    updateAIMessage(loadingId, '‚ö†Ô∏è –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.');
                }
            }, 800);
        }

        function addAIMessage(text, sender = 'ai', isLoading = false) {
            const container = document.getElementById('aiMessages');
            const messageId = generateId();
            
            const messageDiv = document.createElement('div');
            messageDiv.className = 'ai-message';
            messageDiv.style.background = sender === 'user' ? 'var(--sap-blue-light)' : 'var(--sap-gray-light)';
            messageDiv.style.textAlign = sender === 'user' ? 'right' : 'left';
            messageDiv.dataset.id = messageId;
            
            if (isLoading) {
                messageDiv.innerHTML = `<div class="loader" style="display: inline-block;"></div> ${text}`;
            } else {
                messageDiv.innerHTML = text;
            }
            
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
            
            return messageId;
        }

        function updateAIMessage(id, newText) {
            const message = document.querySelector(`[data-id="${id}"]`);
            if (message) {
                message.innerHTML = newText;
            }
        }

        function handleAIKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendAIMessage();
            }
        }

        function generateWithAI() {
            const title = document.getElementById('instructionTitle').value.trim();
            const module = document.getElementById('instructionModule').value;
            
            const topic = title || (module ? 
                Object.keys(sapAI.knowledgeBase.modules).find(m => m === module)?.description || '–ù–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è' 
                : '–ù–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ SAP');
            
            const aiButton = document.getElementById('aiGenerateBtn');
            const originalText = aiButton.innerHTML;
            aiButton.innerHTML = '<div class="loader"></div> –ê–Ω–∞–ª–∏–∑...';
            aiButton.disabled = true;
            
            setTimeout(() => {
                const instruction = sapAI.generateCompleteInstruction(topic);
                
                // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É
                document.getElementById('instructionTitle').value = instruction.title;
                document.getElementById('instructionModule').value = instruction.module || module || 'FI';
                document.getElementById('transactionCode').value = instruction.transactionCode || '';
                document.getElementById('instructionTags').value = instruction.tags.join(', ');
                document.getElementById('instructionNotes').value = instruction.notes || '';
                
                // –î–æ–±–∞–≤–ª—è–µ–º —à–∞–≥–∏
                const stepsContainer = document.getElementById('stepsContainer');
                stepsContainer.innerHTML = '';
                instruction.steps.forEach((step, index) => {
                    const stepDiv = document.createElement('div');
                    stepDiv.className = 'steps-container';
                    stepDiv.innerHTML = `
                        <input type="text" class="form-control step-input" value="${step}" placeholder="–®–∞–≥ ${index + 1}">
                        ${index === 0 ? 
                            '<button type="button" class="btn btn-icon" onclick="addStep()"><i class="fas fa-plus"></i></button>' :
                            '<button type="button" class="btn btn-icon" onclick="removeStep(this)"><i class="fas fa-minus"></i></button>'
                        }
                    `;
                    stepsContainer.appendChild(stepDiv);
                });
                
                aiButton.innerHTML = originalText;
                aiButton.disabled = false;
                
                showNotification('‚úÖ AI —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é', 'success');
                
                setTimeout(() => {
                    addAIMessage(
                        `‚úÖ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è "${instruction.title}" –¥–ª—è –º–æ–¥—É–ª—è ${instruction.module}. ` +
                        `–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —à–∞–≥–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.`,
                        'ai'
                    );
                }, 500);
            }, 1200);
        }

        function toggleAIPanel() {
            const panel = document.getElementById('aiPanel');
            aiPanelVisible = !aiPanelVisible;
            panel.classList.toggle('active', aiPanelVisible);
            
            if (aiPanelVisible) {
                document.getElementById('aiInput').focus();
            }
        }

        // ===================== –ò–ú–ü–û–†–¢/–≠–ö–°–ü–û–†–¢ =====================
        function exportData() {
            const userKey = `sapAssistantData_${currentUser.id}`;
            const userData = JSON.parse(localStorage.getItem(userKey));
            
            if (!userData || !userData.instructions || userData.instructions.length === 0) {
                showNotification('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞', 'warning');
                return;
            }
            
            const exportData = {
                ...userData,
                exportDate: new Date().toISOString(),
                appVersion: '1.0'
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `sap-assistant-backup-${currentUser.id}-${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            showNotification('–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã', 'success');
        }

        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = e => {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = event => {
                    try {
                        const importedData = JSON.parse(event.target.result);
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö
                        if (!importedData.instructions || !Array.isArray(importedData.instructions)) {
                            throw new Error('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞');
                        }
                        
                        // –°–æ–∑–¥–∞–µ–º —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –ø–µ—Ä–µ–¥ –∏–º–ø–æ—Ä—Ç–æ–º
                        const backup = {
                            instructions: [...instructions],
                            backupDate: new Date().toISOString()
                        };
                        
                        const userKey = `sapAssistantData_${currentUser.id}`;
                        const userData = JSON.parse(localStorage.getItem(userKey));
                        userData.backups = userData.backups || [];
                        userData.backups.push(backup);
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
                        instructions = importedData.instructions.map(instr => ({
                            ...instr,
                            userId: currentUser.id // –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –∫ —Ç–µ–∫—É—â–µ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
                        }));
                        
                        userData.instructions = instructions;
                        localStorage.setItem(userKey, JSON.stringify(userData));
                        
                        displayInstructions();
                        showNotification(`–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ ${instructions.length} –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π`, 'success');
                        
                    } catch (error) {
                        showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ —Ñ–∞–π–ª–∞', 'error');
                        console.error('Import error:', error);
                    }
                };
                reader.readAsText(file);
            };
            
            input.click();
        }

        // ===================== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ú =====================
        function showUserMenu() {
            document.getElementById('userMenu').classList.add('active');
        }

        function hideUserMenu() {
            document.getElementById('userMenu').classList.remove('active');
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
            const newName = document.getElementById('changeUserName').value.trim();
            if (newName && newName !== currentUser.name) {
                currentUser.name = newName;
                currentUser.avatar = newName.charAt(0).toUpperCase();
                localStorage.setItem('sapAssistantUser', JSON.stringify(currentUser));
                
                document.getElementById('userName').textContent = currentUser.name;
                document.getElementById('userAvatar').textContent = currentUser.avatar;
                
                showNotification('–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–æ', 'success');
            }
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É
            const theme = document.getElementById('themeSelect').value;
            applyTheme(theme);
            
            saveUserData();
        }

        function clearUserData() {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã? –í—Å–µ –≤–∞—à–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è.')) return;
            
            const userKey = `sapAssistantData_${currentUser.id}`;
            const emptyData = {
                instructions: [],
                favorites: [],
                recent: [],
                backups: [],
                version: '1.0'
            };
            
            localStorage.setItem(userKey, JSON.stringify(emptyData));
            instructions = [];
            displayInstructions();
            
            showNotification('–í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã', 'warning');
            hideUserMenu();
        }

        // ===================== –¢–ï–ú–´ –ò –ù–ê–°–¢–†–û–ô–ö–ò =====================
        function applyTheme(theme) {
            document.body.classList.remove('theme-dark', 'theme-fiori');
            
            if (theme === 'dark') {
                document.body.classList.add('theme-dark');
                document.body.style.backgroundColor = '#1a1a1a';
                document.body.style.color = '#ffffff';
            } else if (theme === 'fiori') {
                document.body.classList.add('theme-fiori');
            } else {
                document.body.style.backgroundColor = '';
                document.body.style.color = '';
            }
            
            currentUser.settings.theme = theme;
        }

        // ===================== –£–¢–ò–õ–ò–¢–´ =====================
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diff = now - date;
            const diffDays = Math.floor(diff / (1000 * 60 * 60 * 24));
            
            if (diffDays === 0) {
                return '–°–µ–≥–æ–¥–Ω—è';
            } else if (diffDays === 1) {
                return '–í—á–µ—Ä–∞';
            } else if (diffDays < 7) {
                return `${diffDays} –¥–Ω–µ–π –Ω–∞–∑–∞–¥`;
            } else {
                return date.toLocaleDateString('ru-RU');
            }
        }

        function truncateText(text, maxLength) {
            if (text.length <= maxLength) return text;
            return text.substr(0, maxLength) + '...';
        }

        function isValidUrl(string) {
            try {
                new URL(string);
                return true;
            } catch (_) {
                return false;
            }
        }

        function showNotification(message, type = 'info') {
            const container = document.getElementById('notificationContainer');
            const id = generateId();
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.dataset.id = id;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i>
                <span>${message}</span>
            `;
            
            container.appendChild(notification);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ
            setTimeout(() => {
                const notif = document.querySelector(`[data-id="${id}"]`);
                if (notif) {
                    notif.style.opacity = '0';
                    notif.style.transform = 'translateX(100px)';
                    setTimeout(() => notif.remove(), 300);
                }
            }, 5000);
        }

        function updateStats() {
            document.getElementById('totalInstructions').textContent = instructions.length;
            document.getElementById('favoriteCount').textContent = instructions.filter(i => i.isFavorite).length;
            
            const uniqueModules = new Set(instructions.map(i => i.module));
            document.getElementById('moduleCount').textContent = uniqueModules.size;
            
            // –í—ã—á–∏—Å–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (–ø—Ä–æ—Ü–µ–Ω—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π —Å –º–µ–¥–∏–∞ –∏ —Ç–µ–≥–∞–º–∏)
            const completeInstructions = instructions.filter(i => 
                i.steps.length >= 3 && 
                (i.media.length > 0 || i.tags.length > 0)
            ).length;
            
            const activityScore = instructions.length > 0 ? 
                Math.round((completeInstructions / instructions.length) * 100) : 0;
            document.getElementById('activityScore').textContent = `${activityScore}%`;
        }

        function getRecentInstructions() {
            return [...instructions]
                .sort((a, b) => new Date(b.updatedAt) - new Date(a.updatedAt))
                .slice(0, 10)
                .map(i => i.id);
        }

        function setupAutoSave() {
            if (currentUser.settings.autoSave) {
                // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
                let saveTimeout;
                
                const inputs = document.querySelectorAll('input, textarea, select');
                inputs.forEach(input => {
                    input.addEventListener('input', () => {
                        clearTimeout(saveTimeout);
                        saveTimeout = setTimeout(saveUserData, 30000);
                    });
                });
                
                // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                window.addEventListener('beforeunload', () => {
                    if (document.querySelector('.modal.active')) {
                        saveUserData();
                    }
                });
            }
        }

        function showTutorial() {
            showNotification('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ SAP Assistant Pro! –ù–∞—á–Ω–∏—Ç–µ —Å —Å–æ–∑–¥–∞–Ω–∏—è –ø–µ—Ä–≤–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.', 'info');
            
            // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —Å–æ–∑–¥–∞–Ω–∏—è
            const createBtn = document.querySelector('[onclick="showNewInstructionModal()"]');
            createBtn.classList.add('tutorial-highlight');
            
            setTimeout(() => {
                createBtn.classList.remove('tutorial-highlight');
                currentUser.settings.tutorialCompleted = true;
                saveUserData();
            }, 5000);
        }

        function setupEventListeners() {
            // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∞–≤–∏—à
            document.addEventListener('keydown', (e) => {
                // Ctrl/Cmd + S –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                    e.preventDefault();
                    if (document.getElementById('instructionModal').classList.contains('active')) {
                        saveInstruction();
                    }
                }
                
                // Escape –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
                if (e.key === 'Escape') {
                    hideModal();
                    hideUserMenu();
                    if (aiPanelVisible) toggleAIPanel();
                }
                
                // Ctrl/Cmd + F –¥–ª—è –ø–æ–∏—Å–∫–∞
                if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
                    e.preventDefault();
                    document.getElementById('searchInput').focus();
                }
                
                // Ctrl/Cmd + N –¥–ª—è –Ω–æ–≤–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
                if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
                    e.preventDefault();
                    showNewInstructionModal();
                }
            });
            
            // –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö
            window.addEventListener('beforeunload', (e) => {
                const modal = document.querySelector('.modal.active');
                if (modal && !modal.id.includes('userMenu')) {
                    e.preventDefault();
                    e.returnValue = '–£ –≤–∞—Å –µ—Å—Ç—å –Ω–µ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è. –í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–π—Ç–∏?';
                }
            });
        }

        // ===================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï =====================
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM fully loaded and parsed');
            initializeApp();
            setupEventListeners();
        });
    </script>
</body>
</html>
